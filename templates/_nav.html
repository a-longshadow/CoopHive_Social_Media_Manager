{% load static %}
<style>
.navbar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 24px;
    background: rgba(255,255,255,0.7);
    backdrop-filter: blur(12px);
    position: sticky;
    top: 0;
    width: 100%;
    z-index: 50;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
}
.nav-left img {
    height: 32px;
    vertical-align: middle;
}
.nav-links {
    display: flex;
    align-items: center;
    gap: 24px;
}
.nav-links a {
    font-weight: 600;
    color: #374151;
    text-decoration: none;
    transition: color .3s;
}
.nav-links a:hover {
    color: #111827;
}
.nav-links a.logout {
    color: #ef4444;
}
.user-profile {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 6px 12px;
    border-radius: 8px;
    background: rgba(255,255,255,0.5);
    border: 1px solid rgba(0,0,0,0.05);
}
.user-profile img {
    width: 28px;
    height: 28px;
    border-radius: 50%;
    border: 1px solid rgba(0,0,0,0.1);
}
.user-avatar {
    width: 28px;
    height: 28px;
    border-radius: 50%;
    background: linear-gradient(45deg, #4f46e5, #7c3aed);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: bold;
    font-size: 12px;
}
.user-name {
    font-size: 14px;
    font-weight: 600;
    color: #374151;
}
</style>

<nav class="navbar">
  <div class="nav-left">
    <a href="/"><img src="{% static 'coophive_logo.webp' %}" alt="CoopHive logo"></a>
  </div>
  <div class="nav-links">
    <a href="/">Home</a>
    {% if user.is_authenticated %}
      <a href="/campaigns/">Campaigns</a>
      <a href="/posts/new/">New Post</a>
      <a href="/posts/">My Posts</a>
      {% if user.is_superuser %}
        <a href="/admin/">Admin</a>
      {% endif %}

      <!-- User Profile Section -->
      <a href="/user_account_manager/profile/" class="user-profile">
        <!-- Profile Picture -->
        {% with google_account=user.socialaccount_set.all.0 %}
          {% if google_account.provider == 'google' and google_account.extra_data.picture %}
            <img src="{{ google_account.extra_data.picture }}"
                 alt="Profile"
                 onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
            <div class="user-avatar" style="display:none;">
              {{ user.first_name|first|default:user.username|first|upper }}
            </div>
          {% else %}
            <div class="user-avatar">
              {{ user.first_name|first|default:user.username|first|upper }}
            </div>
          {% endif %}
        {% endwith %}

        <!-- User Name -->
        <span class="user-name">
          {% if user.get_full_name %}
            {{ user.get_full_name|truncatechars:20 }}
          {% else %}
            {{ user.username|truncatechars:15 }}
          {% endif %}
        </span>
      </a>

      <a href="/user_account_manager/logout/" class="logout">Log&nbsp;out</a>
    {% else %}
      <a href="/user_account_manager/register/">Register</a>
      <a href="/user_account_manager/login/?next=/campaigns/">Log&nbsp;in</a>
    {% endif %}
  </div>
</nav>
