{% extends "base.html" %}
{% load form_tags %}
{% block content %}
<div class="flex justify-center mt-24">
  <div class="bg-white shadow-lg rounded-lg p-8 w-full max-w-md">
    <h2 class="text-2xl font-bold mb-6 text-center">Log in to CoopHive</h2>

    <!-- Google OAuth Button -->
    <form method="post" action="/accounts/google/login/{% if request.GET.next %}?next={{ request.GET.next }}{% endif %}" style="margin: 0;">
      {% csrf_token %}
      <button type="submit" class="w-full flex items-center justify-center gap-3 bg-[#4285F4] text-white py-3 rounded mb-4 hover:opacity-90">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" class="h-6 w-6 bg-white rounded-full p-1">
          <path fill="#4285F4" d="M24 9.5c3.1 0 5.9 1.1 8.1 2.9l6-6C34.4 3.5 29.6 1.5 24 1.5 14.9 1.5 7 6.9 3.4 14.3l6.9 5.4C12.5 13 17.8 9.5 24 9.5z"/>
          <path fill="#34A853" d="M46.5 24c0-1.6-.1-2.8-.4-4.1H24v7.8h12.6c-.5 3-2.1 5.5-4.5 7.2l7 5.4c4.1-3.8 6.4-9.4 6.4-16.3z"/>
          <path fill="#FBBC05" d="M10.3 28.2c-.5-1.6-.8-3.3-.8-5 0-1.7.3-3.4.8-5L3.4 12.8C1.8 16 1 19.4 1 23c0 3.6.8 7 2.4 10.2l6.9-5z"/>
          <path fill="#EA4335" d="M24 46c5.6 0 10.4-1.8 13.9-4.8l-7-5.4c-2 1.4-4.6 2.3-7 2.3-6.2 0-11.5-4.2-13.3-10.1l-6.9 5.3C7 41.1 14.9 46 24 46z"/>
        </svg>
        <span class="font-medium">Continue with Google</span>
      </button>
    </form>

    <div class="text-center text-xs text-gray-400 mb-4">or sign in with username/email</div>

    <form method="post" class="space-y-4">
      {% csrf_token %}
      {{ form.non_field_errors }}
      <div>
        {{ form.username.label_tag }}
        {{ form.username|add_class:"w-full border border-gray-300 rounded p-2" }}
        {{ form.username.errors }}
      </div>
      <div class="relative">
        {{ form.password.label_tag }}
        {{ form.password|add_class:"w-full border border-gray-300 rounded p-2 pr-10" }}
        {{ form.password.errors }}
        <button type="button" onclick="togglePw(this)" class="absolute inset-y-0 right-2 flex items-center text-gray-500">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
          </svg>
        </button>
      </div>
      <button class="w-full py-2 font-semibold text-white rounded bg-gradient-to-r from-indigo-500 to-purple-500 hover:opacity-90">Log in</button>
    </form>
    
    <p class="text-center text-sm mt-4">
      No account? <a href="{% url 'accounts:register' %}" class="text-blue-600 hover:underline">Register</a> |
      <a href="{% url 'accounts:reset' %}" class="text-blue-600 hover:underline">Forgot password?</a>
    </p>
  </div>
</div>

<script>
function togglePw(btn){
  const input = btn.parentElement.querySelector('input');
  input.type = input.type === 'password' ? 'text' : 'password';
  btn.querySelector('svg').classList.toggle('opacity-50');
}
</script>
{% endblock %}
